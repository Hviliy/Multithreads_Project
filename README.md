# Парсер отзывов

Итоговое домашнее задание по "Теория и практика многопоточности", многопоточное Spring Boot приложение, которое запускает задачи парсинга отзывов. Выполнил Данила Копылов

## Поддерживаются:
- **Steam** (получение отзывов через публичный эндпоинт)
- **Стаб-источник** (генерирует тестовые отзывы для любой строки/URL)

## Требования
- **Java 21**
- **Maven**

## Инструкции по запуску
1. Открыть/клонировать репозиторий в IDE
2. Собираем проект и запускаем тесты ```mvn clean test```
3. Если тесты прошли успешно, то запускаем приложение
4. В браузере уже можно открыть:
   - Страницу панель: http://localhost:8080/
   - Swagger: http://localhost:8080/swagger-ui/index.html#/
   - H2 консоль: http://localhost:8080/h2-console

## Подключение к H2
Для начало открываем http://localhost:8080/h2-console и заполняем поля если не заполнены:
- JDBC URL: jdbc:h2:mem:testdb
- User Name: sa
- Password: оставляем пустым

Жмём connect

## Запуск парсинга

Запустить парсинг можно 3 вариантами:
1. Через страницу панель:
   - Открываем http://localhost:8080/
   - Вставляем url из steam (например: https://store.steampowered.com/app/108600/Project_Zomboid/) или же любой текст для генерации тестовых отзывов
   - Жмём кнопку запуска
   - В блоке просмотра результатов жмём "загрузить" и видим отзывы
2. Через Swagger:
   - Открываем http://localhost:8080/swagger-ui/index.html#/
   - Находим POST /parse
   - Жмём "Try it out"
   - В JSON вставляем ссылку или же любой текст
   - Жмём "Execute"
   - Получаем результаты через GET /answer
3. Через консоль(PowerShell):
   - Запуск задачи ```Invoke-RestMethod -Method Post `
  -Uri "http://localhost:8080/parse" `
  -ContentType "application/json" `
  -Body '{"url":"https://store.steampowered.com/app/730/"}'```
   - Получение отзывов: ```Invoke-RestMethod -Method Get `
  -Uri "http://localhost:8080/answer?page=0&size=20&sort=fetchedAt,desc"```

## Запуск планировщика (авто-парсинг по расписанию)
Планировщик раз в 30 секунд запускает парсинг для включённых источников из таблицы sources
1. Через панель:
   - В блоке источников для планировщика добавляем url из стима или любую строку
   - Жмем добавить источник
   - Ждём 30 секунд
   - В блоке резулатов жмём кнопку загрузки и видим результат
   - Также источник можно выключить при необходимости
2. В Swagger:
   - Добавляем источник в POST /sources
   - Проверяем появился ли он в GET /sources
   - Проверяем результаты в GET /answer
   - Отключаем при необходимости в POST /sources/{id}/disable или включить обратно в POST /sources/{id}/enable


